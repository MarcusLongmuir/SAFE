function Page(){var a=this;a.element=$("<div />")}function SAFE(){var a=this;Site=this,a.debug=!1,a.initial_url=!0,a.map={},a.ignore_next_url=!1,a.origin=window.location.protocol+"//"+window.location.hostname,""!=window.location.port&&(a.origin+=":"+window.location.port),a.path="",a.url_changed_callback=function(){},a.transition_page_callback=function(){return!1},a.pre_load_callback=function(){return null},a.on_resize=function(){},a.scroll_bar_width_value=-1,a.element=$("<div />"),a.is_touchscreen="ontouchstart"in document.documentElement,a.history_state_supported=!(!window.history||!window.history.pushState),a.current_page=null,a.no_page_found_class=null}if(function(a,b){"use strict";var c=a.History=a.History||{},d=a.jQuery;if("undefined"!=typeof c.Adapter)throw new Error("History.js Adapter has already been loaded...");c.Adapter={bind:function(a,b,c){d(a).bind(b,c)},trigger:function(a,b,c){d(a).trigger(b,c)},extractEventData:function(a,c,d){var e=c&&c.originalEvent&&c.originalEvent[a]||d&&d[a]||b;return e},onDomLoad:function(a){d(a)}},"undefined"!=typeof c.init&&c.init()}(window),function(a,b){"use strict";var c=a.console||b,d=a.document,e=a.navigator,f=!1,g=a.setTimeout,h=a.clearTimeout,i=a.setInterval,j=a.clearInterval,k=a.JSON,l=a.alert,m=a.History=a.History||{},n=a.history;try{f=a.sessionStorage,f.setItem("TEST","1"),f.removeItem("TEST")}catch(o){f=!1}if(k.stringify=k.stringify||k.encode,k.parse=k.parse||k.decode,"undefined"!=typeof m.init)throw new Error("History.js Core has already been loaded...");m.init=function(){return"undefined"==typeof m.Adapter?!1:("undefined"!=typeof m.initCore&&m.initCore(),"undefined"!=typeof m.initHtml4&&m.initHtml4(),!0)},m.initCore=function(){if("undefined"!=typeof m.initCore.initialized)return!1;if(m.initCore.initialized=!0,m.options=m.options||{},m.options.hashChangeInterval=m.options.hashChangeInterval||100,m.options.safariPollInterval=m.options.safariPollInterval||500,m.options.doubleCheckInterval=m.options.doubleCheckInterval||500,m.options.disableSuid=m.options.disableSuid||!1,m.options.storeInterval=m.options.storeInterval||1e3,m.options.busyDelay=m.options.busyDelay||250,m.options.debug=m.options.debug||!1,m.options.initialTitle=m.options.initialTitle||d.title,m.options.html4Mode=m.options.html4Mode||!1,m.options.delayInit=m.options.delayInit||!1,m.intervalList=[],m.clearAllIntervals=function(){var a,b=m.intervalList;if("undefined"!=typeof b&&null!==b){for(a=0;a<b.length;a++)j(b[a]);m.intervalList=null}},m.debug=function(){m.options.debug&&m.log.apply(m,arguments)},m.log=function(){var a,b,e,f,g,h=!("undefined"==typeof c||"undefined"==typeof c.log||"undefined"==typeof c.log.apply),i=d.getElementById("log");for(h?(f=Array.prototype.slice.call(arguments),a=f.shift(),"undefined"!=typeof c.debug?c.debug.apply(c,[a,f]):c.log.apply(c,[a,f])):a="\n"+arguments[0]+"\n",b=1,e=arguments.length;e>b;++b){if(g=arguments[b],"object"==typeof g&&"undefined"!=typeof k)try{g=k.stringify(g)}catch(j){}a+="\n"+g+"\n"}return i?(i.value+=a+"\n-----\n",i.scrollTop=i.scrollHeight-i.clientHeight):h||l(a),!0},m.getInternetExplorerMajorVersion=function(){var a=m.getInternetExplorerMajorVersion.cached="undefined"!=typeof m.getInternetExplorerMajorVersion.cached?m.getInternetExplorerMajorVersion.cached:function(){for(var a=3,b=d.createElement("div"),c=b.getElementsByTagName("i");(b.innerHTML="<!--[if gt IE "+ ++a+"]><i></i><![endif]-->")&&c[0];);return a>4?a:!1}();return a},m.isInternetExplorer=function(){var a=m.isInternetExplorer.cached="undefined"!=typeof m.isInternetExplorer.cached?m.isInternetExplorer.cached:Boolean(m.getInternetExplorerMajorVersion());return a},m.emulated=m.options.html4Mode?{pushState:!0,hashChange:!0}:{pushState:!Boolean(a.history&&a.history.pushState&&a.history.replaceState&&!(/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(e.userAgent)||/AppleWebKit\/5([0-2]|3[0-2])/i.test(e.userAgent))),hashChange:Boolean(!("onhashchange"in a||"onhashchange"in d)||m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<8)},m.enabled=!m.emulated.pushState,m.bugs={setHash:Boolean(!m.emulated.pushState&&"Apple Computer, Inc."===e.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),safariPoll:Boolean(!m.emulated.pushState&&"Apple Computer, Inc."===e.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(e.userAgent)),ieDoubleCheck:Boolean(m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(m.isInternetExplorer()&&m.getInternetExplorerMajorVersion()<7)},m.isEmptyObject=function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},m.cloneObject=function(a){var b,c;return a?(b=k.stringify(a),c=k.parse(b)):c={},c},m.getRootUrl=function(){var a=d.location.protocol+"//"+(d.location.hostname||d.location.host);return d.location.port&&(a+=":"+d.location.port),a+="/"},m.getBaseHref=function(){var a=d.getElementsByTagName("base"),b=null,c="";return 1===a.length&&(b=a[0],c=b.href.replace(/[^\/]+$/,"")),c=c.replace(/\/+$/,""),c&&(c+="/"),c},m.getBaseUrl=function(){var a=m.getBaseHref()||m.getBasePageUrl()||m.getRootUrl();return a},m.getPageUrl=function(){var a,b=m.getState(!1,!1),c=(b||{}).url||m.getLocationHref();return a=c.replace(/\/+$/,"").replace(/[^\/]+$/,function(a){return/\./.test(a)?a:a+"/"})},m.getBasePageUrl=function(){var a=m.getLocationHref().replace(/[#\?].*/,"").replace(/[^\/]+$/,function(a){return/[^\/]$/.test(a)?"":a}).replace(/\/+$/,"")+"/";return a},m.getFullUrl=function(a,b){var c=a,d=a.substring(0,1);return b="undefined"==typeof b?!0:b,/[a-z]+\:\/\//.test(a)||(c="/"===d?m.getRootUrl()+a.replace(/^\/+/,""):"#"===d?m.getPageUrl().replace(/#.*/,"")+a:"?"===d?m.getPageUrl().replace(/[\?#].*/,"")+a:b?m.getBaseUrl()+a.replace(/^(\.\/)+/,""):m.getBasePageUrl()+a.replace(/^(\.\/)+/,"")),c.replace(/\#$/,"")},m.getShortUrl=function(a){var b=a,c=m.getBaseUrl(),d=m.getRootUrl();return m.emulated.pushState&&(b=b.replace(c,"")),b=b.replace(d,"/"),m.isTraditionalAnchor(b)&&(b="./"+b),b=b.replace(/^(\.\/)+/g,"./").replace(/\#$/,"")},m.getLocationHref=function(a){return a=a||d,a.URL===a.location.href?a.location.href:a.location.href===decodeURIComponent(a.URL)?a.URL:a.location.hash&&decodeURIComponent(a.location.href.replace(/^[^#]+/,""))===a.location.hash?a.location.href:-1==a.URL.indexOf("#")&&-1!=a.location.href.indexOf("#")?a.location.href:a.URL||a.location.href},m.store={},m.idToState=m.idToState||{},m.stateToId=m.stateToId||{},m.urlToId=m.urlToId||{},m.storedStates=m.storedStates||[],m.savedStates=m.savedStates||[],m.normalizeStore=function(){m.store.idToState=m.store.idToState||{},m.store.urlToId=m.store.urlToId||{},m.store.stateToId=m.store.stateToId||{}},m.getState=function(a,b){"undefined"==typeof a&&(a=!0),"undefined"==typeof b&&(b=!0);var c=m.getLastSavedState();return!c&&b&&(c=m.createStateObject()),a&&(c=m.cloneObject(c),c.url=c.cleanUrl||c.url),c},m.getIdByState=function(a){var b,c=m.extractId(a.url);if(!c)if(b=m.getStateString(a),"undefined"!=typeof m.stateToId[b])c=m.stateToId[b];else if("undefined"!=typeof m.store.stateToId[b])c=m.store.stateToId[b];else{for(;;)if(c=(new Date).getTime()+String(Math.random()).replace(/\D/g,""),"undefined"==typeof m.idToState[c]&&"undefined"==typeof m.store.idToState[c])break;m.stateToId[b]=c,m.idToState[c]=a}return c},m.normalizeState=function(a){var b,c;return a&&"object"==typeof a||(a={}),"undefined"!=typeof a.normalized?a:(a.data&&"object"==typeof a.data||(a.data={}),b={},b.normalized=!0,b.title=a.title||"",b.url=m.getFullUrl(a.url?a.url:m.getLocationHref()),b.hash=m.getShortUrl(b.url),b.data=m.cloneObject(a.data),b.id=m.getIdByState(b),b.cleanUrl=b.url.replace(/\??\&_suid.*/,""),b.url=b.cleanUrl,c=!m.isEmptyObject(b.data),(b.title||c)&&m.options.disableSuid!==!0&&(b.hash=m.getShortUrl(b.url).replace(/\??\&_suid.*/,""),/\?/.test(b.hash)||(b.hash+="?"),b.hash+="&_suid="+b.id),b.hashedUrl=m.getFullUrl(b.hash),(m.emulated.pushState||m.bugs.safariPoll)&&m.hasUrlDuplicate(b)&&(b.url=b.hashedUrl),b)},m.createStateObject=function(a,b,c){var d={data:a,title:b,url:c};return d=m.normalizeState(d)},m.getStateById=function(a){a=String(a);var c=m.idToState[a]||m.store.idToState[a]||b;return c},m.getStateString=function(a){var b,c,d;return b=m.normalizeState(a),c={data:b.data,title:a.title,url:a.url},d=k.stringify(c)},m.getStateId=function(a){var b,c;return b=m.normalizeState(a),c=b.id},m.getHashByState=function(a){var b,c;return b=m.normalizeState(a),c=b.hash},m.extractId=function(a){var b,c,d,e;return e=-1!=a.indexOf("#")?a.split("#")[0]:a,c=/(.*)\&_suid=([0-9]+)$/.exec(e),d=c?c[1]||a:a,b=c?String(c[2]||""):"",b||!1},m.isTraditionalAnchor=function(a){var b=!/[\/\?\.]/.test(a);return b},m.extractState=function(a,b){var c,d,e=null;return b=b||!1,c=m.extractId(a),c&&(e=m.getStateById(c)),e||(d=m.getFullUrl(a),c=m.getIdByUrl(d)||!1,c&&(e=m.getStateById(c)),e||!b||m.isTraditionalAnchor(a)||(e=m.createStateObject(null,null,d))),e},m.getIdByUrl=function(a){var c=m.urlToId[a]||m.store.urlToId[a]||b;return c},m.getLastSavedState=function(){return m.savedStates[m.savedStates.length-1]||b},m.getLastStoredState=function(){return m.storedStates[m.storedStates.length-1]||b},m.hasUrlDuplicate=function(a){var b,c=!1;return b=m.extractState(a.url),c=b&&b.id!==a.id},m.storeState=function(a){return m.urlToId[a.url]=a.id,m.storedStates.push(m.cloneObject(a)),a},m.isLastSavedState=function(a){var b,c,d,e=!1;return m.savedStates.length&&(b=a.id,c=m.getLastSavedState(),d=c.id,e=b===d),e},m.saveState=function(a){return m.isLastSavedState(a)?!1:(m.savedStates.push(m.cloneObject(a)),!0)},m.getStateByIndex=function(a){var b=null;return b="undefined"==typeof a?m.savedStates[m.savedStates.length-1]:0>a?m.savedStates[m.savedStates.length+a]:m.savedStates[a]},m.getCurrentIndex=function(){var a=null;return a=m.savedStates.length<1?0:m.savedStates.length-1},m.getHash=function(a){var b,c=m.getLocationHref(a);return b=m.getHashByUrl(c)},m.unescapeHash=function(a){var b=m.normalizeHash(a);return b=decodeURIComponent(b)},m.normalizeHash=function(a){var b=a.replace(/[^#]*#/,"").replace(/#.*/,"");return b},m.setHash=function(a,b){var c,e;return b!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.setHash,args:arguments,queue:b}),!1):(m.busy(!0),c=m.extractState(a,!0),c&&!m.emulated.pushState?m.pushState(c.data,c.title,c.url,!1):m.getHash()!==a&&(m.bugs.setHash?(e=m.getPageUrl(),m.pushState(null,null,e+"#"+a,!1)):d.location.hash=a),m)},m.escapeHash=function(b){var c=m.normalizeHash(b);return c=a.encodeURIComponent(c),m.bugs.hashEscape||(c=c.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),c},m.getHashByUrl=function(a){var b=String(a).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return b=m.unescapeHash(b)},m.setTitle=function(a){var b,c=a.title;c||(b=m.getStateByIndex(0),b&&b.url===a.url&&(c=b.title||m.options.initialTitle));try{d.getElementsByTagName("title")[0].innerHTML=c.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(e){}return d.title=c,m},m.queues=[],m.busy=function(a){if("undefined"!=typeof a?m.busy.flag=a:"undefined"==typeof m.busy.flag&&(m.busy.flag=!1),!m.busy.flag){h(m.busy.timeout);var b=function(){var a,c,d;if(!m.busy.flag)for(a=m.queues.length-1;a>=0;--a)c=m.queues[a],0!==c.length&&(d=c.shift(),m.fireQueueItem(d),m.busy.timeout=g(b,m.options.busyDelay))};m.busy.timeout=g(b,m.options.busyDelay)}return m.busy.flag},m.busy.flag=!1,m.fireQueueItem=function(a){return a.callback.apply(a.scope||m,a.args||[])},m.pushQueue=function(a){return m.queues[a.queue||0]=m.queues[a.queue||0]||[],m.queues[a.queue||0].push(a),m},m.queue=function(a,b){return"function"==typeof a&&(a={callback:a}),"undefined"!=typeof b&&(a.queue=b),m.busy()?m.pushQueue(a):m.fireQueueItem(a),m},m.clearQueue=function(){return m.busy.flag=!1,m.queues=[],m},m.stateChanged=!1,m.doubleChecker=!1,m.doubleCheckComplete=function(){return m.stateChanged=!0,m.doubleCheckClear(),m},m.doubleCheckClear=function(){return m.doubleChecker&&(h(m.doubleChecker),m.doubleChecker=!1),m},m.doubleCheck=function(a){return m.stateChanged=!1,m.doubleCheckClear(),m.bugs.ieDoubleCheck&&(m.doubleChecker=g(function(){return m.doubleCheckClear(),m.stateChanged||a(),!0},m.options.doubleCheckInterval)),m},m.safariStatePoll=function(){var b,c=m.extractState(m.getLocationHref());if(!m.isLastSavedState(c))return b=c,b||(b=m.createStateObject()),m.Adapter.trigger(a,"popstate"),m},m.back=function(a){return a!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.back,args:arguments,queue:a}),!1):(m.busy(!0),m.doubleCheck(function(){m.back(!1)}),n.go(-1),!0)},m.forward=function(a){return a!==!1&&m.busy()?(m.pushQueue({scope:m,callback:m.forward,args:arguments,queue:a}),!1):(m.busy(!0),m.doubleCheck(function(){m.forward(!1)}),n.go(1),!0)},m.go=function(a,b){var c;if(a>0)for(c=1;a>=c;++c)m.forward(b);else{if(!(0>a))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(c=-1;c>=a;--c)m.back(b)}return m},m.emulated.pushState){var o=function(){};m.pushState=m.pushState||o,m.replaceState=m.replaceState||o}else m.onPopState=function(b,c){var d,e,f=!1,g=!1;return m.doubleCheckComplete(),(d=m.getHash())?(e=m.extractState(d||m.getLocationHref(),!0),e?m.replaceState(e.data,e.title,e.url,!1):(m.Adapter.trigger(a,"anchorchange"),m.busy(!1)),m.expectedStateId=!1,!1):(f=m.Adapter.extractEventData("state",b,c)||!1,g=f?m.getStateById(f):m.expectedStateId?m.getStateById(m.expectedStateId):m.extractState(m.getLocationHref()),g||(g=m.createStateObject(null,null,m.getLocationHref())),m.expectedStateId=!1,m.isLastSavedState(g)?(m.busy(!1),!1):(m.storeState(g),m.saveState(g),m.setTitle(g),m.Adapter.trigger(a,"statechange"),m.busy(!1),!0))},m.Adapter.bind(a,"popstate",m.onPopState),m.pushState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(e!==!1&&m.busy())return m.pushQueue({scope:m,callback:m.pushState,args:arguments,queue:e}),!1;m.busy(!0);var f=m.createStateObject(b,c,d);return m.isLastSavedState(f)?m.busy(!1):(m.storeState(f),m.expectedStateId=f.id,n.pushState(f.id,f.title,f.url),m.Adapter.trigger(a,"popstate")),!0},m.replaceState=function(b,c,d,e){if(m.getHashByUrl(d)&&m.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(e!==!1&&m.busy())return m.pushQueue({scope:m,callback:m.replaceState,args:arguments,queue:e}),!1;m.busy(!0);var f=m.createStateObject(b,c,d);return m.isLastSavedState(f)?m.busy(!1):(m.storeState(f),m.expectedStateId=f.id,n.replaceState(f.id,f.title,f.url),m.Adapter.trigger(a,"popstate")),!0};if(f){try{m.store=k.parse(f.getItem("History.store"))||{}}catch(p){m.store={}}m.normalizeStore()}else m.store={},m.normalizeStore();m.Adapter.bind(a,"unload",m.clearAllIntervals),m.saveState(m.storeState(m.extractState(m.getLocationHref(),!0))),f&&(m.onUnload=function(){var a,b,c;try{a=k.parse(f.getItem("History.store"))||{}}catch(d){a={}}a.idToState=a.idToState||{},a.urlToId=a.urlToId||{},a.stateToId=a.stateToId||{};for(b in m.idToState)m.idToState.hasOwnProperty(b)&&(a.idToState[b]=m.idToState[b]);for(b in m.urlToId)m.urlToId.hasOwnProperty(b)&&(a.urlToId[b]=m.urlToId[b]);for(b in m.stateToId)m.stateToId.hasOwnProperty(b)&&(a.stateToId[b]=m.stateToId[b]);m.store=a,m.normalizeStore(),c=k.stringify(a);try{f.setItem("History.store",c)}catch(e){if(e.code!==DOMException.QUOTA_EXCEEDED_ERR)throw e;f.length&&(f.removeItem("History.store"),f.setItem("History.store",c))}},m.intervalList.push(i(m.onUnload,m.options.storeInterval)),m.Adapter.bind(a,"beforeunload",m.onUnload),m.Adapter.bind(a,"unload",m.onUnload)),m.emulated.pushState||(m.bugs.safariPoll&&m.intervalList.push(i(m.safariStatePoll,m.options.safariPollInterval)),("Apple Computer, Inc."===e.vendor||"Mozilla"===(e.appCodeName||""))&&(m.Adapter.bind(a,"hashchange",function(){m.Adapter.trigger(a,"popstate")}),m.getHash()&&m.Adapter.onDomLoad(function(){m.Adapter.trigger(a,"hashchange")})))},m.options&&m.options.delayInit||m.init()}(window),function(a){a.fn.ajax_url=function(b,c){var d=this;return d.tappable(function(e){var f=null;null!=b&&(f=b(e)),null==f||1==f?(null!=c&&c(e),1==e.metaKey||Site.history_state_supported&&(e.isDefaultPrevented()||(e.preventDefault(),Site.load_url(a(d).attr("href"),!0)))):e.preventDefault()}),d}}(jQuery),function(a){var b="ontouchstart"in window;a.fn.tappable=function(c){var d,e=!0,f=function(){return!0},g=0;switch(typeof c){case"function":d=c;break;case"object":d=c.callback,"undefined"!=typeof c.cancelOnMove&&(e=c.cancelOnMove),"undefined"!=typeof c.onlyIf&&(f=c.onlyIf),"undefined"!=typeof c.touchDelay&&(g=c.touchDelay)}var h=function(a,b){"function"==typeof d&&f(a)&&(d.call(a,b),b.preventDefault(),b.stopPropagation())};return b?(this.unbind("touchstart"),this.bind("touchstart",function(){var b=this;return f(this)&&(a(b).addClass("touch-started"),window.setTimeout(function(){a(b).hasClass("touch-started")&&a(b).addClass("touched")},g)),!0}),this.unbind("touchend"),this.bind("touchend",function(b){var c=this;if(a(c).hasClass("touch-started")){if(a(c).removeClass("touched").removeClass("touch-started"),a(b.target).is('input[type="checkbox"]')&&a(b.target).attr("checked",!a(b.target).is(":checked")),a(b.target).is("label")){var d=a(b.target).attr("for"),e=a("#"+d);e.is(":checkbox")?e.attr("checked",!e.is(":checked")):e.focus()}if(a(b.target).is("a")){var f=a(b.target),g=f.attr("href");if(""!==g&&"javascript:;"!==g&&g.indexOf("#")<0)return"_blank"===f.attr("target")?window.open(f.attr("href")):window.location.href=f.attr("href"),!1}h(c,b)}return!0}),this.unbind("click"),this.bind("click",function(a){a.preventDefault()}),e&&(this.unbind("touchmove"),this.bind("touchmove",function(){a(this).removeClass("touched").removeClass("touch-started")}))):"function"==typeof d&&(this.unbind("click"),this.bind("click",function(a){f(this)&&d.call(this,a)})),this}}(jQuery),Page.prototype.new_url=function(){return"NOT_SET"},Page.prototype.get_title=function(){return null},Page.prototype.shows_menu=function(){return!1},Page.prototype.resize=function(){},Page.prototype.init=function(){},Page.prototype.remove=function(){},SAFE.console=console,"undefined"==typeof SAFE.console){var cons={};cons.log=cons.error=cons.info=cons.debug=cons.warn=cons.trace=cons.dir=cons.dirxml=cons.group=cons.groupEnd=cons.time=cons.timeEnd=cons.assert=cons.profile=function(){},SAFE.console=cons}SAFE.prototype.extend=function(a,b){function c(){}c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.superConstructor=b,a.superClass=b.prototype},SAFE.prototype.build_query_string=function(a){var b="",c=!1,d=[];for(var e in a)c=!0,d.push(encodeURIComponent(e)+"="+encodeURIComponent(a[e]));return c&&(b="?"+d.join("&")),b},SAFE.prototype.use_page_class=function(a,b,c,d){var e=this;if(null==a){if(null==e.no_page_found_class)return null!=e.current_page&&(e.current_page.remove(),e.current_page=null,e.previous_class_name=null),void e.element.text("No 404 page set. Use Site.set_no_page_found_class(class_name) to set one.");a=e.no_page_found_class}if(a==e.previous_class_name){var f=e.current_page.new_url(b,c,d);if("NOT_SET"!=f)return}var g=null;null!=e.current_page&&(e.current_page.remove(),g=e.current_page);var h=e.pre_load_callback(a,b,c,d);if(null!=h)return void e.load_url(h,!0);e.current_page=new_page=new a(b,c,d),e.previous_class_name=a;var i=e.transition_page_callback(e.current_page,g);1==i||(e.element.empty(),e.element.append(e.current_page.element)),e.current_page.init(),e.resize()},SAFE.prototype.set_no_page_found_class=function(a){var b=this;b.no_page_found_class=a},SAFE.prototype.ajax_post=function(a){return a.cache=!1,a.type="post",a.contentType="application/json; charset=utf-8",a.data=JSON.stringify(a.data),a.dataType="json",$.ajax(a)},SAFE.prototype.ajax_get=function(a){return a.cache=!1,a.dataType="json",a.type="get",$.ajax(a)},SAFE.prototype.ajax_delete=function(a){return a.cache=!1,a.dataType="json",a.type="delete",$.ajax(a)},SAFE.prototype.resize=function(){var a=this,b=$(window).width()-a.scroll_bar_width(),c=$(window).height(),d={scroll_bar_width:a.scroll_bar_width(),doc_width:b,doc_height:c};a.on_resize(d),null!=a.current_page&&a.current_page.resize(d)},SAFE.prototype.init=function(a){var b=this,c=window.location.pathname;null!=window.location.search&&(c+=window.location.search);var d=decodeURIComponent(c);return null==a||a==d||(d=a,b.history_state_supported)?(b.history_state_supported&&(History.replaceState(null,"",Site.origin+d),History.Adapter.bind(window,"statechange",function(){if(b.ignore_next_url)return void(b.ignore_next_url=!1);var a=History.getState();null!=a&&b.load_url(decodeURIComponent(a.url),!1)})),$(window).resize(function(){b.resize()}).resize(),null==d&&(d=""),void b.load_url(d,!1)):void(window.location=a)},SAFE.prototype.reload_page=function(){var a=this;a.use_page_class(a.current_class_and_details.class_name,a.current_class_and_details.parameters,a.current_class_and_details.url,a.current_class_and_details.wildcard_contents)},SAFE.prototype.replace_current_url=function(a){var b=this;History.replaceState(null,"",Site.origin+a),b.url_changed_callback(window.location.toString(),window.location.pathname,window.location.toString().substring(Site.origin.length),!1)},SAFE.prototype.add_url=function(a,b){var c=this;c.map[a]=b},SAFE.prototype.scroll_bar_width=function(){var a=this;if(-1!=a.scroll_bar_width_value)return a.scroll_bar_width_value;var b=$('<div style="width:50px;height:50px;overflow:hidden;position:absolute;top:-200px;left:-200px;"><div style="height:100px;"></div>');$("body").append(b);var c=$("div",b).innerWidth();b.css("overflow-y","scroll");var d=$("div",b).innerWidth();return b.remove(),a.scroll_bar_width_value=c-d,a.scroll_bar_width_value},SAFE.prototype.parse_query_string=function(a){for(var b=a.split("&"),c={},d=0;d<b.length;d++)pair=b[d].split("="),c[decodeURIComponent(pair[0])]=decodeURIComponent(pair[1]);return c},SAFE.prototype.get_class_for_url=function(a){var b=this,c=b.get_class_and_details_for_url(a);return null!=c?c.class_name:null},SAFE.prototype.get_class_and_details_for_url=function(a){var b=this,c={},d=a.split("?");d.length>1&&(c=b.parse_query_string(d[1])),url=d[0],url.length>=b.origin.length&&url.substring(0,b.origin.length)==b.origin&&(url=url.substring(b.origin.length));var e=b.path;if(""!=e&&"/"!=e[e.length-1]&&(e+="/"),e.length>0){if(e.length>url.length||url.substring(0,e.length)!=e)return SAFE.console.error("The requested url ("+a+") was not relative to the domain/origin and within the Site.path scope"),null;url=url.substring(e.length-1)}var f=b.map[url],g=null,g=null;if(null==f)for(var h in b.map){var i=h.indexOf("*");if(-1!=i){var j=h.substring(0,i);j.length<url.length&&j==url.substring(0,j.length)&&(f=b.map[h],g=url.substring(j.length),url=j+"*")}}return{class_name:f,parameters:c,url:url,wildcard_contents:g}},SAFE.prototype.load_url=function(a,b){var c=this;if(c.history_state_supported)b&&(c.ignore_next_url=!0,History.pushState(null,"",Site.origin+a));else{var d=encodeURI(Site.origin+a);if(window.location!=d)return void(window.location=d)}c.current_class_and_details=c.get_class_and_details_for_url(a),null!=c.current_class_and_details.class_name?c.use_page_class(c.current_class_and_details.class_name,c.current_class_and_details.parameters,c.current_class_and_details.url,c.current_class_and_details.wildcard_contents):(SAFE.console.error("Page not found for url ("+c.current_class_and_details.url+"). The full url was ("+a+")"),c.use_page_class(null)),c.url_changed_callback(window.location.toString(),window.location.pathname,window.location.toString().substring(Site.origin.length),c.initial_url),c.initial_url=!1,c.previous_class_name=c.current_class_and_details.class_name};var Site;new SAFE;